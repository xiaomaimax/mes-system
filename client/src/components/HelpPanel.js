/**
 * HelpPanel - å¸®åŠ©é¢æ¿ç»„ä»¶
 * 
 * åŠŸèƒ½ï¼š
 * - æ˜¾ç¤ºå½“å‰é¡µé¢çš„å¸®åŠ©ä¿¡æ¯
 * - æä¾›å¸¸è§é—®é¢˜è§£ç­”
 * - æ”¯æŒå±•å¼€/æ”¶èµ·
 */

import React, { useState } from 'react';
import { Card, Collapse, Button, Drawer, Space, Tag, Empty } from 'antd';
import { QuestionCircleOutlined, CloseOutlined, FileTextOutlined } from '@ant-design/icons';

const HelpPanel = ({ moduleKey, title, description, features, faqs, tips }) => {
  const [isOpen, setIsOpen] = useState(false);
  const [expandedFaq, setExpandedFaq] = useState(null);

  // å¸®åŠ©å†…å®¹åº“
  const helpContent = {
    dashboard: {
      title: 'ä»ªè¡¨æ¿å¸®åŠ©',
      description: 'ä»ªè¡¨æ¿æ˜¯æ‚¨äº†è§£ç”Ÿäº§çŠ¶æ€çš„ä¸­å¿ƒã€‚å®ƒæ˜¾ç¤ºå…³é”®ä¸šåŠ¡æŒ‡æ ‡å’Œå®æ—¶æ•°æ®ã€‚',
      features: [
        'å®æ—¶ç›‘æ§å…³é”®æŒ‡æ ‡ï¼ˆäº§é‡ã€è´¨é‡ã€æ•ˆç‡ç­‰ï¼‰',
        'æŸ¥çœ‹ç”Ÿäº§è¶‹åŠ¿å’Œéƒ¨é—¨ç»©æ•ˆ',
        'å¿«é€Ÿè®¿é—®å…¶ä»–åŠŸèƒ½æ¨¡å—'
      ],
      faqs: [
        {
          question: 'å¦‚ä½•æ›´æ–°ä»ªè¡¨æ¿ä¸Šçš„æ•°æ®ï¼Ÿ',
          answer: 'æ•°æ®ä¼šè‡ªåŠ¨å®æ—¶æ›´æ–°ã€‚å¦‚éœ€æ‰‹åŠ¨åˆ·æ–°ï¼Œè¯·æŒ‰ F5 æˆ–ç‚¹å‡»æµè§ˆå™¨çš„åˆ·æ–°æŒ‰é’®ã€‚'
        },
        {
          question: 'æˆ‘å¯ä»¥è‡ªå®šä¹‰ä»ªè¡¨æ¿å—ï¼Ÿ',
          answer: 'ç›®å‰ä»ªè¡¨æ¿æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„æ ‡å‡†æŒ‡æ ‡ã€‚æœªæ¥ç‰ˆæœ¬å°†æ”¯æŒè‡ªå®šä¹‰ã€‚'
        },
        {
          question: 'å¦‚ä½•å¯¼å‡ºä»ªè¡¨æ¿æ•°æ®ï¼Ÿ',
          answer: 'ç‚¹å‡»"æŸ¥çœ‹è¯¦ç»†æŠ¥è¡¨"æŒ‰é’®è¿›å…¥æŠ¥è¡¨æ¨¡å—ï¼Œå¯ä»¥å¯¼å‡ºå„ç§æ ¼å¼çš„æ•°æ®ã€‚'
        }
      ],
      tips: [
        'ğŸ’¡ ç‚¹å‡»ä»»ä½•æŒ‡æ ‡å¡ç‰‡å¯ä»¥æŸ¥çœ‹æ›´è¯¦ç»†çš„æ•°æ®',
        'ğŸ’¡ ä½¿ç”¨å·¦ä¾§èœå•å¿«é€Ÿåˆ‡æ¢åˆ°å…¶ä»–åŠŸèƒ½æ¨¡å—',
        'ğŸ’¡ å®šæœŸæ£€æŸ¥ä»ªè¡¨æ¿ä»¥äº†è§£ç”Ÿäº§è¿›åº¦'
      ]
    },
    production: {
      title: 'ç”Ÿäº§ç®¡ç†å¸®åŠ©',
      description: 'ç”Ÿäº§ç®¡ç†æ¨¡å—ç”¨äºç®¡ç†ç”Ÿäº§è®¡åˆ’ã€ä»»åŠ¡åˆ†é…å’Œè¿›åº¦è·Ÿè¸ªã€‚',
      features: [
        'åˆ›å»ºå’Œç®¡ç†ç”Ÿäº§è®¡åˆ’',
        'åˆ†é…ç”Ÿäº§ä»»åŠ¡ç»™å‘˜å·¥',
        'å®æ—¶è·Ÿè¸ªä»»åŠ¡è¿›åº¦',
        'è®°å½•ç”Ÿäº§æ•°æ®å’ŒæŠ¥å·¥'
      ],
      faqs: [
        {
          question: 'å¦‚ä½•åˆ›å»ºæ–°çš„ç”Ÿäº§è®¡åˆ’ï¼Ÿ',
          answer: 'ç‚¹å‡»"æ–°å»ºè®¡åˆ’"æŒ‰é’®ï¼Œå¡«å†™è®¡åˆ’ä¿¡æ¯ï¼ˆäº§å“ã€æ•°é‡ã€æˆªæ­¢æ—¥æœŸç­‰ï¼‰ï¼Œç„¶åä¿å­˜ã€‚'
        },
        {
          question: 'å¦‚ä½•åˆ†é…ä»»åŠ¡ç»™å‘˜å·¥ï¼Ÿ',
          answer: 'åœ¨è®¡åˆ’è¯¦æƒ…é¡µé¢ï¼Œç‚¹å‡»"åˆ†é…ä»»åŠ¡"ï¼Œé€‰æ‹©å‘˜å·¥å’Œä»»åŠ¡ç±»å‹ï¼Œè®¾ç½®æˆªæ­¢æ—¶é—´ã€‚'
        },
        {
          question: 'å¦‚ä½•æ›´æ–°ä»»åŠ¡è¿›åº¦ï¼Ÿ',
          answer: 'ç‚¹å‡»ä»»åŠ¡å¡ç‰‡ï¼Œåœ¨"è¿›åº¦"å­—æ®µè¾“å…¥å®Œæˆç™¾åˆ†æ¯”ï¼Œæˆ–ç›´æ¥æ‹–åŠ¨è¿›åº¦æ¡ã€‚'
        }
      ],
      tips: [
        'ğŸ’¡ å®šæœŸæ£€æŸ¥ä»»åŠ¡è¿›åº¦ï¼ŒåŠæ—¶å‘ç°å»¶æœŸé£é™©',
        'ğŸ’¡ ä½¿ç”¨ç­›é€‰åŠŸèƒ½å¿«é€Ÿæ‰¾åˆ°ç‰¹å®šçš„è®¡åˆ’æˆ–ä»»åŠ¡',
        'ğŸ’¡ ä¸ºé‡è¦ä»»åŠ¡è®¾ç½®æé†’ï¼Œç¡®ä¿æŒ‰æ—¶å®Œæˆ'
      ]
    },
    quality: {
      title: 'è´¨é‡ç®¡ç†å¸®åŠ©',
      description: 'è´¨é‡ç®¡ç†æ¨¡å—ç”¨äºè®°å½•å’Œç›‘æ§äº§å“è´¨é‡æ•°æ®ã€‚',
      features: [
        'è®°å½•æ£€éªŒæ•°æ®ï¼ˆIQCã€PQCã€FQCã€OQCï¼‰',
        'ç›‘æ§äº§å“åˆæ ¼ç‡',
        'è¿½è¸ªä¸è‰¯å“å’Œè¿”å·¥',
        'ç”Ÿæˆè´¨é‡æŠ¥å‘Š'
      ],
      faqs: [
        {
          question: 'å¦‚ä½•è®°å½•æ£€éªŒæ•°æ®ï¼Ÿ',
          answer: 'ç‚¹å‡»"æ–°å»ºæ£€éªŒ"ï¼Œé€‰æ‹©æ£€éªŒç±»å‹ï¼Œè¾“å…¥æ£€éªŒé¡¹ç›®å’Œç»“æœï¼Œä¿å­˜å³å¯ã€‚'
        },
        {
          question: 'å¦‚ä½•å¤„ç†ä¸è‰¯å“ï¼Ÿ',
          answer: 'åœ¨æ£€éªŒè®°å½•ä¸­æ ‡è®°ä¸º"ä¸è‰¯"ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆè¿”å·¥å•ã€‚'
        },
        {
          question: 'å¦‚ä½•æŸ¥çœ‹è´¨é‡è¶‹åŠ¿ï¼Ÿ',
          answer: 'è¿›å…¥"æŠ¥è¡¨åˆ†æ"æ¨¡å—ï¼Œé€‰æ‹©"è´¨é‡åˆ†æ"å¯ä»¥æŸ¥çœ‹åˆæ ¼ç‡ã€CPK ç­‰è¶‹åŠ¿ã€‚'
        }
      ],
      tips: [
        'ğŸ’¡ åŠæ—¶è®°å½•æ£€éªŒæ•°æ®ï¼Œç¡®ä¿æ•°æ®å‡†ç¡®æ€§',
        'ğŸ’¡ å®šæœŸæŸ¥çœ‹è´¨é‡æŒ‡æ ‡ï¼Œå‘ç°é—®é¢˜åŠæ—¶æ”¹è¿›',
        'ğŸ’¡ ä½¿ç”¨è´¨é‡æŠ¥å‘Šæ”¯æŒç®¡ç†å†³ç­–'
      ]
    },
    inventory: {
      title: 'åº“å­˜ç®¡ç†å¸®åŠ©',
      description: 'åº“å­˜ç®¡ç†æ¨¡å—ç”¨äºç®¡ç†åŸææ–™å’Œæˆå“åº“å­˜ã€‚',
      features: [
        'ç®¡ç†åº“å­˜ç‰©æ–™',
        'è®°å½•å‡ºå…¥åº“æ“ä½œ',
        'åº“å­˜é¢„è­¦å’Œè¡¥è´§æé†’',
        'åº“å­˜åˆ†æå’Œä¼˜åŒ–'
      ],
      faqs: [
        {
          question: 'å¦‚ä½•æ·»åŠ æ–°ç‰©æ–™ï¼Ÿ',
          answer: 'ç‚¹å‡»"æ–°å»ºç‰©æ–™"ï¼Œå¡«å†™ç‰©æ–™ä¿¡æ¯ï¼ˆåç§°ã€è§„æ ¼ã€å•ä½ç­‰ï¼‰ï¼Œè®¾ç½®åº“å­˜é¢„è­¦å€¼ã€‚'
        },
        {
          question: 'å¦‚ä½•è®°å½•å‡ºåº“ï¼Ÿ',
          answer: 'ç‚¹å‡»"å‡ºåº“"ï¼Œé€‰æ‹©ç‰©æ–™å’Œæ•°é‡ï¼Œè¾“å…¥ç”¨é€”ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ›´æ–°åº“å­˜ã€‚'
        },
        {
          question: 'å¦‚ä½•å¤„ç†åº“å­˜é¢„è­¦ï¼Ÿ',
          answer: 'å½“åº“å­˜ä½äºé¢„è­¦å€¼æ—¶ï¼Œç³»ç»Ÿä¼šæé†’ã€‚ç‚¹å‡»æé†’å¯ä»¥å¿«é€Ÿåˆ›å»ºè¡¥è´§å•ã€‚'
        }
      ],
      tips: [
        'ğŸ’¡ å®šæœŸæ£€æŸ¥åº“å­˜é¢„è­¦ï¼ŒåŠæ—¶è¡¥è´§',
        'ğŸ’¡ ä½¿ç”¨åº“å­˜åˆ†æä¼˜åŒ–åº“å­˜ç»“æ„',
        'ğŸ’¡ å‡†ç¡®è®°å½•å‡ºå…¥åº“ï¼Œç¡®ä¿è´¦å®ä¸€è‡´'
      ]
    },
    reports: {
      title: 'æŠ¥è¡¨åˆ†æå¸®åŠ©',
      description: 'æŠ¥è¡¨åˆ†ææ¨¡å—æä¾›å¤šç»´åº¦çš„æ•°æ®åˆ†æå’Œå¯è§†åŒ–ã€‚',
      features: [
        'ç”Ÿäº§åˆ†ææŠ¥è¡¨',
        'è´¨é‡åˆ†ææŠ¥è¡¨',
        'åº“å­˜åˆ†ææŠ¥è¡¨',
        'ç»©æ•ˆè¯„ä¼°æŠ¥è¡¨'
      ],
      faqs: [
        {
          question: 'å¦‚ä½•ç”ŸæˆæŠ¥è¡¨ï¼Ÿ',
          answer: 'é€‰æ‹©æŠ¥è¡¨ç±»å‹ï¼Œè®¾ç½®æ—¶é—´èŒƒå›´å’Œç­›é€‰æ¡ä»¶ï¼Œç‚¹å‡»"ç”Ÿæˆ"å³å¯ã€‚'
        },
        {
          question: 'å¦‚ä½•å¯¼å‡ºæŠ¥è¡¨ï¼Ÿ',
          answer: 'æŠ¥è¡¨ç”Ÿæˆåï¼Œç‚¹å‡»"å¯¼å‡º"æŒ‰é’®ï¼Œé€‰æ‹©å¯¼å‡ºæ ¼å¼ï¼ˆExcelã€PDF ç­‰ï¼‰ã€‚'
        },
        {
          question: 'å¦‚ä½•å®šæ—¶ç”ŸæˆæŠ¥è¡¨ï¼Ÿ',
          answer: 'ç‚¹å‡»"å®šæ—¶ä»»åŠ¡"ï¼Œè®¾ç½®ç”Ÿæˆé¢‘ç‡å’Œæ¥æ”¶äººï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆå¹¶å‘é€ã€‚'
        }
      ],
      tips: [
        'ğŸ’¡ å®šæœŸæŸ¥çœ‹æŠ¥è¡¨ï¼Œäº†è§£ä¸šåŠ¡è¶‹åŠ¿',
        'ğŸ’¡ ä½¿ç”¨æŠ¥è¡¨æ•°æ®æ”¯æŒå†³ç­–åˆ¶å®š',
        'ğŸ’¡ å¯¼å‡ºæŠ¥è¡¨ç”¨äºä¼šè®®å’Œæ±‡æŠ¥'
      ]
    }
  };

  const content = helpContent[moduleKey] || {
    title: 'å¸®åŠ©',
    description: 'æ¬¢è¿ä½¿ç”¨ MES ç³»ç»Ÿã€‚å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ä¸‹æ–¹çš„å¸¸è§é—®é¢˜ã€‚',
    features: [],
    faqs: [],
    tips: []
  };

  const faqItems = (content.faqs || []).map((faq, index) => ({
    key: index,
    label: faq.question,
    children: <p style={{ margin: 0, color: '#666', lineHeight: 1.6 }}>{faq.answer}</p>
  }));

  return (
    <>
      {/* å¸®åŠ©æŒ‰é’® */}
      <Button
        type="text"
        icon={<QuestionCircleOutlined />}
        onClick={() => setIsOpen(true)}
        style={{ color: '#1890ff' }}
        title="ç‚¹å‡»æŸ¥çœ‹å¸®åŠ©"
      />

      {/* å¸®åŠ©æŠ½å±‰ */}
      <Drawer
        title={
          <Space>
            <FileTextOutlined style={{ color: '#1890ff' }} />
            <span>{content.title}</span>
          </Space>
        }
        placement="right"
        onClose={() => setIsOpen(false)}
        open={isOpen}
        width={400}
        bodyStyle={{ padding: '16px' }}
      >
        {/* æ¨¡å—æè¿° */}
        <Card
          size="small"
          style={{ marginBottom: '16px', background: '#f0f7ff', border: '1px solid #b3d8ff' }}
        >
          <p style={{ margin: 0, color: '#0050b3', fontSize: '14px', lineHeight: 1.6 }}>
            {content.description}
          </p>
        </Card>

        {/* æ ¸å¿ƒåŠŸèƒ½ */}
        {content.features && content.features.length > 0 && (
          <div style={{ marginBottom: '16px' }}>
            <h4 style={{ marginBottom: '8px', color: '#1890ff' }}>æ ¸å¿ƒåŠŸèƒ½</h4>
            <ul style={{ margin: 0, paddingLeft: '20px', color: '#666', fontSize: '13px' }}>
              {content.features.map((feature, index) => (
                <li key={index} style={{ marginBottom: '4px' }}>
                  {feature}
                </li>
              ))}
            </ul>
          </div>
        )}

        {/* å¸¸è§é—®é¢˜ */}
        {content.faqs && content.faqs.length > 0 && (
          <div style={{ marginBottom: '16px' }}>
            <h4 style={{ marginBottom: '8px', color: '#1890ff' }}>å¸¸è§é—®é¢˜</h4>
            <Collapse
              items={faqItems}
              size="small"
              style={{ background: 'transparent' }}
            />
          </div>
        )}

        {/* æç¤º */}
        {content.tips && content.tips.length > 0 && (
          <div style={{ marginBottom: '16px' }}>
            <h4 style={{ marginBottom: '8px', color: '#1890ff' }}>ä½¿ç”¨æç¤º</h4>
            <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
              {content.tips.map((tip, index) => (
                <div
                  key={index}
                  style={{
                    padding: '8px 12px',
                    background: '#fffbe6',
                    border: '1px solid #ffe58f',
                    borderRadius: '4px',
                    fontSize: '13px',
                    color: '#666',
                    lineHeight: 1.5
                  }}
                >
                  {tip}
                </div>
              ))}
            </div>
          </div>
        )}

        {/* åº•éƒ¨æç¤º */}
        <Card
          size="small"
          style={{ marginTop: '16px', background: '#f6f8fb', border: '1px solid #d9d9d9' }}
        >
          <p style={{ margin: 0, fontSize: '12px', color: '#999' }}>
            ğŸ’¬ å¦‚éœ€æ›´å¤šå¸®åŠ©ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜æˆ–æŸ¥çœ‹å®Œæ•´æ–‡æ¡£ã€‚
          </p>
        </Card>
      </Drawer>
    </>
  );
};

export default HelpPanel;
