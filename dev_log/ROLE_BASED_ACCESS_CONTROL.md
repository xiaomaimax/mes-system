# MES系统角色权限控制说明

## 🔐 权限控制概述

MES系统现已实现基于角色和部门的精细化权限控制，不同角色的用户登录后将看到不同的功能模块，确保系统安全和操作规范。

## 👥 角色权限配置

### 1. 超级管理员 (admin)
- **部门**: 信息部
- **权限**: 全部模块访问权限
- **可访问模块**: 
  - ✅ 首页
  - ✅ 工艺管理
  - ✅ 生产管理
  - ✅ 设备管理
  - ✅ 质量管理
  - ✅ 库存管理
  - ✅ 人员管理
  - ✅ 系统集成
  - ✅ 报表分析
  - ✅ 系统设置

### 2. 部门管理员
根据不同部门有不同的管理权限：

#### 生产部管理员 (prod_manager)
- **部门**: 生产部
- **权限**: 生产相关模块管理权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 生产管理
  - ✅ 设备管理
  - ✅ 库存管理
  - ✅ 报表分析

#### 质量部管理员
- **部门**: 质量部
- **权限**: 质量相关模块管理权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 质量管理
  - ✅ 工艺管理
  - ✅ 报表分析

#### 技术部管理员
- **部门**: 技术部
- **权限**: 技术相关模块管理权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 工艺管理
  - ✅ 设备管理
  - ✅ 系统集成
  - ✅ 报表分析

#### 信息部管理员
- **部门**: 信息部
- **权限**: 系统相关模块管理权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 系统集成
  - ✅ 系统设置
  - ✅ 报表分析

### 3. 技术管理员 (tech_engineer)
- **部门**: 技术部
- **权限**: 技术专业模块权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 工艺管理
  - ✅ 设备管理
  - ✅ 系统集成
  - ✅ 报表分析

### 4. 普通用户
根据不同部门有基础操作权限：

#### 生产部普通用户
- **部门**: 生产部
- **权限**: 生产基础操作权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 生产管理
  - ✅ 报表分析

#### 质量部普通用户 (quality_user)
- **部门**: 质量部
- **权限**: 质量基础操作权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 质量管理
  - ✅ 报表分析

#### 技术部普通用户
- **部门**: 技术部
- **权限**: 工艺基础操作权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 工艺管理
  - ✅ 报表分析

#### 信息部普通用户
- **部门**: 信息部
- **权限**: 基础查看权限
- **可访问模块**:
  - ✅ 首页
  - ✅ 报表分析

## 🎯 权限控制特性

### 1. 菜单级权限控制
- **侧边栏菜单**: 根据用户权限动态显示可访问的菜单项
- **首页模块**: 只显示用户有权限访问的功能模块卡片
- **路由保护**: 防止用户通过URL直接访问无权限的页面

### 2. 用户身份识别
- **侧边栏显示**: Logo区域显示当前用户的部门和角色信息
- **首页欢迎**: 欢迎区域显示用户姓名和角色信息
- **头部用户信息**: 右上角显示详细的用户信息

### 3. 动态布局适配
- **模块卡片**: 根据用户可访问的模块数量自动调整布局
- **响应式设计**: 适配不同权限级别的界面展示
- **用户体验**: 确保不同角色用户都有良好的使用体验

## 🔧 技术实现

### 权限配置文件
```javascript
const rolePermissions = {
  '超级管理员': {
    allowedMenus: ['/dashboard', '/process', '/production', ...]
  },
  '部门管理员': {
    生产部: ['/dashboard', '/production', '/equipment', ...],
    质量部: ['/dashboard', '/quality', '/process', ...],
    // ...
  },
  '普通用户': {
    生产部: ['/dashboard', '/production', '/reports'],
    质量部: ['/dashboard', '/quality', '/reports'],
    // ...
  }
};
```

### 权限验证逻辑
1. **用户登录**: 保存用户角色和部门信息到localStorage
2. **权限获取**: 根据角色和部门获取可访问的菜单列表
3. **菜单过滤**: 在Sidebar和HomePage中过滤显示允许的模块
4. **路由保护**: 在App.js中验证用户访问权限

## 📊 权限矩阵

| 模块 | 超级管理员 | 生产部管理员 | 质量部管理员 | 技术部管理员 | 技术管理员 | 生产部用户 | 质量部用户 | 技术部用户 |
|------|------------|--------------|--------------|--------------|------------|------------|------------|------------|
| 首页 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 工艺管理 | ✅ | ❌ | ✅ | ✅ | ✅ | ❌ | ❌ | ✅ |
| 生产管理 | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ❌ | ❌ |
| 设备管理 | ✅ | ✅ | ❌ | ✅ | ✅ | ❌ | ❌ | ❌ |
| 质量管理 | ✅ | ❌ | ✅ | ❌ | ❌ | ❌ | ✅ | ❌ |
| 库存管理 | ✅ | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 人员管理 | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 系统集成 | ✅ | ❌ | ❌ | ✅ | ✅ | ❌ | ❌ | ❌ |
| 报表分析 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 系统设置 | ✅ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ |

## 🚀 使用示例

### 测试不同角色权限
1. **超级管理员**: 使用 `admin/admin123` 登录，可看到全部9个模块
2. **生产部管理员**: 使用 `prod_manager/prod123` 登录，可看到5个模块
3. **质量部用户**: 使用 `quality_user/quality123` 登录，可看到3个模块
4. **技术管理员**: 使用 `tech_engineer/tech123` 登录，可看到5个模块

### 权限验证
- 登录后查看侧边栏菜单数量
- 查看首页显示的模块卡片数量
- 尝试直接访问无权限的URL（会被重定向）

## 🔒 安全特性

1. **前端权限控制**: 菜单和页面级别的访问控制
2. **用户身份验证**: 基于localStorage的用户信息验证
3. **角色权限分离**: 清晰的角色和权限分离设计
4. **部门级权限**: 支持同角色不同部门的差异化权限

---

**注意**: 当前为前端权限控制演示，生产环境需要配合后端API权限验证确保安全性。