# 10种排程规则完整指南

**版本**: v1.0  
**创建时间**: 2025-12-26  
**状态**: ✅ 完成

---

## 🎯 概述

本指南提供了10种排程规则的完整实现和演示。每种规则都有对应的演示场景、验证方法和学习资料。

### 10种排程规则

| # | 规则名称 | 优先级 | 应用场景 |
|---|---------|--------|--------|
| 1️⃣ | 交期优先 | 低 | 紧急订单 |
| 2️⃣ | 设备权重优先 | 中 | 设备选择 |
| 3️⃣ | 模具权重优先 | 中 | 模具选择 |
| 4️⃣ | 模具-设备独占性 | 高 | 资源冲突 |
| 5️⃣ | 模具-设备绑定 | 最高 | 资源绑定 |
| 6️⃣ | 同物料一致性 | 中 | 物料聚集 |
| 7️⃣ | 同模具一致性 | 中 | 模具聚集 |
| 8️⃣ | 计划单唯一性 | 低 | 标准排程 |
| 9️⃣ | 同模多物料同步 | 高 | 同步生产 |
| 🔟 | 多模具灵活排程 | 低 | 灵活选择 |

---

## 📚 文档导航

### 🚀 快速开始 (5分钟)

**文件**: `10-RULES-QUICK-START.md`

**适合**: 第一次使用的用户

**内容**:
- 5分钟快速体验
- 预期排程结果
- 验证清单
- 常见操作

**快速命令**:
```bash
node scripts/init-10-rules-demo-data.js
```

### ✅ 验证指南 (详细)

**文件**: `10-RULES-VERIFICATION-GUIDE.md`

**适合**: 需要详细验证的用户

**内容**:
- 每个规则的详细验证步骤
- 预期的排程原因和分配结果
- 完整的验证清单
- 故障排除指南

### 📖 快速参考 (查阅)

**文件**: `10-RULES-QUICK-REFERENCE.md`

**适合**: 需要快速查阅的用户

**内容**:
- 10种规则的定义
- 触发条件和应用场景
- 规则优先级关系
- 常见问题解答

### 🔧 实现总结 (技术)

**文件**: `../dev_log/10-RULES-DEMO-IMPLEMENTATION.md`

**适合**: 技术人员和系统管理员

**内容**:
- 技术改进说明
- 演示数据统计
- 使用流程
- 后续优化方向

---

## 🎓 学习路径

### 初级用户 (新手)

1. 阅读本文档的概述部分
2. 按照快速启动指南执行
3. 查看排程结果
4. 理解基本概念

**预计时间**: 15分钟

### 中级用户 (业务人员)

1. 阅读快速参考了解规则
2. 按照验证指南逐个验证规则
3. 分析排程原因分布
4. 调整权重值进行实验

**预计时间**: 1小时

### 高级用户 (系统管理员)

1. 阅读实现总结了解技术细节
2. 查看排程引擎源代码
3. 调整规则参数
4. 支持用户的问题解答

**预计时间**: 2小时

---

## 🚀 快速开始

### 前置条件

- ✅ 后端服务运行中 (`npm run dev`)
- ✅ 前端服务运行中 (`npm start`)
- ✅ MySQL 数据库连接正常

### 三步启动

#### 步骤1: 初始化演示数据 (1分钟)

```bash
node scripts/init-10-rules-demo-data.js
```

**预期输出**:
```
✨ 10种排程规则演示数据初始化完成！

📊 数据统计:
  • 物料: 11个
  • 设备: 6个
  • 模具: 8个
  • 计划单: 14个
```

#### 步骤2: 执行排程 (1分钟)

1. 访问 http://localhost:3000
2. 点击"辅助排程"
3. 点击"执行自动排产"
4. 确认操作

#### 步骤3: 查看结果 (1分钟)

1. 点击"排程结果"标签页
2. 查看表格中的"排程原因"列
3. 对比下面的预期结果

### 预期结果

| 规则 | 计划单 | 排程原因 |
|------|--------|--------|
| 1️⃣ | PL-URGENT-001 | 交期优先 |
| 2️⃣ | PL-DEV-WEIGHT-001 | 设备权重优先 |
| 3️⃣ | PL-MOLD-WEIGHT-001 | 模具权重优先 |
| 4️⃣ | PL-EXCLUSIVE-001 | 模具-设备独占性 |
| 5️⃣ | PL-BIND-002 | 模具-设备绑定 |
| 6️⃣ | PL-MAT-CONSIST-002 | 同物料一致性 |
| 7️⃣ | PL-MOLD-CONSIST-002 | 同模具一致性 |
| 8️⃣ | PL-UNIQUE-001 | 计划单唯一性 |
| 9️⃣ | PL-MULTI-MAT-001/002 | 同模多物料同步 |
| 🔟 | PL-FLEXIBLE-001 | 多模具灵活排程 |

---

## 📊 演示数据概览

### 物料 (11个)

```
MAT-001: 手机壳A
MAT-002: 手机壳B
MAT-003: 充电器
MAT-004: 电池盖板
MAT-005: 屏幕保护膜
MAT-006: 手机壳C
MAT-007: 手机壳D
MAT-008: 高端手机壳
MAT-009: 标准手机壳
MAT-010: 手机壳E
MAT-011: 手机壳F
```

### 设备 (6个)

```
DEV-001: 注塑机1号 (权重: 70)
DEV-002: 注塑机2号 (权重: 95)
DEV-003: 注塑机3号 (权重: 60)
DEV-004: 注塑机4号 (权重: 85)
DEV-005: 高速注塑机 (权重: 100)
DEV-006: 标准注塑机 (权重: 50)
```

### 模具 (8个)

```
MOLD-001: 模具A (数量: 2, 权重: 70)
MOLD-002: 模具B (数量: 1, 权重: 85)
MOLD-003: 模具C (数量: 3, 权重: 80)
MOLD-004: 模具D (数量: 2, 权重: 75)
MOLD-005: 通用手机壳模具 (数量: 2, 权重: 88)
MOLD-006: 高精度模具 (数量: 1, 权重: 100)
MOLD-007: 标准模具 (数量: 2, 权重: 50)
MOLD-008: 单副绑定模具 (数量: 1, 权重: 92)
```

### 计划单 (14个)

```
PL-URGENT-001: 演示 1️⃣ 交期优先
PL-DEV-WEIGHT-001: 演示 2️⃣ 设备权重优先
PL-MOLD-WEIGHT-001: 演示 3️⃣ 模具权重优先
PL-EXCLUSIVE-001: 演示 4️⃣ 模具-设备独占性
PL-BIND-001: 演示 8️⃣ 计划单唯一性
PL-BIND-002: 演示 5️⃣ 模具-设备绑定
PL-MAT-CONSIST-001: 演示 2️⃣ 设备权重优先
PL-MAT-CONSIST-002: 演示 6️⃣ 同物料一致性
PL-MOLD-CONSIST-001: 演示 2️⃣ 设备权重优先
PL-MOLD-CONSIST-002: 演示 7️⃣ 同模具一致性
PL-UNIQUE-001: 演示 8️⃣ 计划单唯一性
PL-MULTI-MAT-001: 演示 9️⃣ 同模多物料同步
PL-MULTI-MAT-002: 演示 9️⃣ 同模多物料同步
PL-FLEXIBLE-001: 演示 🔟 多模具灵活排程
```

---

## 🔍 规则详解

### 1️⃣ 交期优先

**定义**: 所有排程决策以满足交期为首要目标

**触发条件**: 交期紧张（< 3天）

**应用场景**: 紧急订单处理

**演示计划单**: PL-URGENT-001 (交期: 2天后)

### 2️⃣ 设备权重优先

**定义**: 权重高的设备优先选择

**触发条件**: 物料有多个可用设备，权重不同

**应用场景**: 多设备选择，提高生产效率

**演示计划单**: PL-DEV-WEIGHT-001 (多个可用设备)

### 3️⃣ 模具权重优先

**定义**: 权重高的模具优先选择

**触发条件**: 物料有多个可用模具，权重不同

**应用场景**: 多模具选择，保证产品质量

**演示计划单**: PL-MOLD-WEIGHT-001 (多个可用模具)

### 4️⃣ 模具-设备独占性

**定义**: 同一模具同一时间只能分配到一台设备

**触发条件**: 模具已被占用，有时间冲突

**应用场景**: 单副模具冲突处理

**演示计划单**: PL-EXCLUSIVE-001 (单副模具)

### 5️⃣ 模具-设备绑定

**定义**: 单副模具一旦分配，后续必须分配到同一设备

**触发条件**: 模具是单副，已分配到某个设备

**应用场景**: 单副模具管理

**演示计划单**: PL-BIND-002 (第二个计划单)

### 6️⃣ 同物料一致性

**定义**: 相同物料优先分配到同一设备和模具

**触发条件**: 相同物料已排产

**应用场景**: 物料聚集生产

**演示计划单**: PL-MAT-CONSIST-002 (第二个计划单)

### 7️⃣ 同模具一致性

**定义**: 使用相同模具的计划单优先分配到同一设备

**触发条件**: 相同模具已使用

**应用场景**: 模具聚集生产

**演示计划单**: PL-MOLD-CONSIST-002 (第二个计划单)

### 8️⃣ 计划单唯一性

**定义**: 每个计划单完整分配到一台设备和一副模具

**触发条件**: 默认规则，其他规则都不适用

**应用场景**: 标准排程

**演示计划单**: PL-UNIQUE-001

### 9️⃣ 同模多物料同步

**定义**: 使用同一模具生产多种物料需同步生产

**触发条件**: 多个计划单使用同一模具，物料不同

**应用场景**: 多物料共享模具

**演示计划单**: PL-MULTI-MAT-001, PL-MULTI-MAT-002

### 🔟 多模具灵活排程

**定义**: 交期不足时可灵活选择其他设备和模具

**触发条件**: 交期紧张，多个设备和模具可用

**应用场景**: 交期冲突处理

**演示计划单**: PL-FLEXIBLE-001 (交期: 3天后)

---

## 💡 使用建议

### 对于新用户

1. 按照快速启动指南执行
2. 查看排程结果
3. 理解基本概念
4. 阅读快速参考了解更多

### 对于业务人员

1. 分析排程原因分布
2. 理解权重对排程的影响
3. 调整权重值进行优化
4. 根据结果改进生产流程

### 对于系统管理员

1. 验证排程逻辑是否正确
2. 检查规则优先级是否合理
3. 调整规则参数
4. 支持用户的问题解答

---

## 🔧 常见操作

### 重置排程结果

```
点击"重置排程结果"按钮 -> 确认
```

### 重新初始化数据

```bash
node scripts/init-10-rules-demo-data.js
```

### 查看计划单详情

```
点击"计划单管理"标签页
```

### 查看任务单详情

```
点击"任务单管理"标签页
```

---

## 📞 获取帮助

### 查看文档

- `10-RULES-QUICK-START.md` - 快速启动指南
- `10-RULES-VERIFICATION-GUIDE.md` - 验证指南
- `10-RULES-QUICK-REFERENCE.md` - 快速参考

### 查看日志

**后端日志**:
```bash
npm run dev
```

**前端日志**:
```
F12 -> Console 标签页
```

### 查看源代码

- `server/services/SchedulingEngine.js` - 排程引擎
- `scripts/init-10-rules-demo-data.js` - 演示数据脚本
- `client/src/components/SimpleScheduling.js` - 前端组件

---

## ✅ 验证清单

快速开始完成后，检查以下内容：

- [ ] 演示数据已初始化
- [ ] 排程已执行
- [ ] 排程结果已查看
- [ ] 预期结果已验证
- [ ] 理解了10种规则
- [ ] 知道如何重置和重新初始化

---

## 🎉 总结

### 完成内容

✅ **排程引擎优化**
- 改进规则检测逻辑
- 支持异步规则验证
- 优化规则优先级

✅ **演示数据完整**
- 11个物料，6个设备，8个模具
- 14个计划单，覆盖10种规则
- 精确的关系配置

✅ **文档完整**
- 快速启动指南
- 详细验证指南
- 快速参考指南
- 实现总结文档

### 立即可用

✅ **运行脚本初始化数据**
```bash
node scripts/init-10-rules-demo-data.js
```

✅ **执行排程查看结果**
- 访问 http://localhost:3000
- 点击"辅助排程" -> "执行自动排产"
- 点击"排程结果"查看每个任务的排程原因

✅ **学习排程系统**
- 理解10种规则的应用
- 分析排程决策过程
- 优化生产流程

---

## 🚀 开始使用

### 第一步: 初始化演示数据

```bash
node scripts/init-10-rules-demo-data.js
```

### 第二步: 访问系统

```
http://localhost:3000
```

### 第三步: 执行排程

1. 点击"辅助排程"
2. 点击"执行自动排产"
3. 确认操作

### 第四步: 查看结果

1. 点击"排程结果"标签页
2. 查看每个任务的排程原因
3. 对比预期结果

---

**现在就开始体验10种排程规则吧！** 🎯

**预计时间**: 5分钟  
**难度**: ⭐ 简单  
**收获**: 理解10种排程规则的应用

---

**版本**: v1.0  
**创建时间**: 2025-12-26  
**状态**: ✅ 完成
