# 10种排程规则快速启动指南

**版本**: v1.0  
**创建时间**: 2025-12-26  
**用途**: 快速体验10种排程规则的演示

---

## ⚡ 5分钟快速开始

### 前置条件

- ✅ 后端服务运行中 (npm run dev)
- ✅ 前端服务运行中 (npm start)
- ✅ MySQL 数据库连接正常

### 步骤1: 初始化演示数据 (1分钟)

```bash
node scripts/init-10-rules-demo-data.js
```

**预期输出**:
```
✨ 10种排程规则演示数据初始化完成！

📊 数据统计:
  • 物料: 11个
  • 设备: 6个
  • 模具: 8个
  • 计划单: 14个
```

### 步骤2: 打开系统 (1分钟)

1. 打开浏览器访问 http://localhost:3000
2. 登录系统（使用默认账号）
3. 点击左侧菜单"辅助排程"

### 步骤3: 执行排程 (1分钟)

1. 在"概览"标签页中
2. 点击"执行自动排产"按钮
3. 在弹出框中点击"确定"

### 步骤4: 查看结果 (2分钟)

1. 点击"排程结果"标签页
2. 查看表格中的"排程原因"列
3. 对比下面的预期结果

---

## 📊 预期排程结果

### 排程原因分布

| 规则 | 计划单 | 排程原因 |
|------|--------|--------|
| 1️⃣ | PL-URGENT-001 | 交期优先 |
| 2️⃣ | PL-DEV-WEIGHT-001 | 设备权重优先 |
| 3️⃣ | PL-MOLD-WEIGHT-001 | 模具权重优先 |
| 4️⃣ | PL-EXCLUSIVE-001 | 模具-设备独占性 |
| 5️⃣ | PL-BIND-002 | 模具-设备绑定 |
| 6️⃣ | PL-MAT-CONSIST-002 | 同物料一致性 |
| 7️⃣ | PL-MOLD-CONSIST-002 | 同模具一致性 |
| 8️⃣ | PL-UNIQUE-001 | 计划单唯一性 |
| 9️⃣ | PL-MULTI-MAT-001/002 | 同模多物料同步 |
| 🔟 | PL-FLEXIBLE-001 | 多模具灵活排程 |

### 总任务单数

**预期**: 14个任务单

---

## 🎯 验证清单

执行排程后，检查以下内容：

- [ ] 所有14个计划单都被排产
- [ ] 每个任务单都有排程原因
- [ ] 排程原因来自10条规则之一
- [ ] 紧急订单 (PL-URGENT-001) 优先排程
- [ ] 权重高的设备被优先选择
- [ ] 权重高的模具被优先选择
- [ ] 单副模具的绑定关系被正确处理
- [ ] 同物料的计划单分配到同一设备
- [ ] 同模具的计划单分配到同一设备
- [ ] 同模多物料的计划单同步排程

---

## 📚 详细文档

### 验证指南

查看每个规则的详细验证步骤：

```
docs/08-scheduling/10-RULES-VERIFICATION-GUIDE.md
```

**包含内容**:
- 每个规则的详细说明
- 预期的排程原因和分配结果
- 完整的验证清单
- 故障排除指南

### 快速参考

查看10种规则的快速参考：

```
docs/08-scheduling/10-RULES-QUICK-REFERENCE.md
```

**包含内容**:
- 10种规则的定义
- 触发条件和应用场景
- 规则优先级关系
- 常见问题解答

### 实现总结

查看实现细节和改进说明：

```
dev_log/10-RULES-DEMO-IMPLEMENTATION.md
```

**包含内容**:
- 技术改进说明
- 演示数据统计
- 使用流程
- 后续优化方向

---

## 🔄 常见操作

### 重置排程结果

如果需要重新执行排程，点击"重置排程结果"按钮：

1. 在"概览"标签页中
2. 点击"重置排程结果"按钮（红色）
3. 在弹出框中点击"确定"
4. 所有任务单将被删除，计划单恢复到未排产状态

### 重新初始化数据

如果需要重新初始化演示数据：

```bash
node scripts/init-10-rules-demo-data.js
```

**注意**: 这会清空所有现有数据并重新创建

### 查看计划单详情

在"计划单管理"标签页中查看所有计划单的详情

### 查看任务单详情

在"任务单管理"标签页中查看所有任务单的详情

---

## 💡 学习建议

### 第一次使用

1. 按照快速开始步骤执行
2. 查看排程结果
3. 对比预期结果
4. 理解基本概念

### 深入学习

1. 阅读验证指南
2. 理解每个规则的触发条件
3. 观察排程系统的决策过程
4. 调整参数进行实验

### 业务应用

1. 分析排程原因分布
2. 理解权重的影响
3. 调整权重值进行优化
4. 根据结果改进流程

---

## 🔧 故障排除

### 问题1: 脚本执行失败

**错误信息**: `Cannot find module`

**解决方案**:
```bash
# 确保在项目根目录
cd /path/to/mes-system

# 重新运行脚本
node scripts/init-10-rules-demo-data.js
```

### 问题2: 数据库连接失败

**错误信息**: `connect ECONNREFUSED`

**解决方案**:
1. 确保 MySQL 服务运行中
2. 检查 `.env` 文件中的数据库配置
3. 确保数据库用户名和密码正确

### 问题3: 排程结果不符合预期

**错误信息**: 所有任务都显示"8️⃣ 计划单唯一性"

**解决方案**:
1. 检查后端服务是否重启
2. 查看后端日志了解排程过程
3. 重新初始化数据
4. 重新执行排程

### 问题4: 某些计划单未被排产

**错误信息**: 任务单数少于14个

**解决方案**:
1. 检查计划单是否有可用的设备和模具
2. 查看后端日志中的警告信息
3. 验证关系配置是否正确

---

## 📞 获取帮助

### 查看日志

**后端日志**:
```bash
# 查看后端输出
npm run dev
```

**前端日志**:
```bash
# 打开浏览器开发者工具
F12 -> Console 标签页
```

### 查看数据库

**查询计划单**:
```sql
SELECT * FROM production_plans;
```

**查询任务单**:
```sql
SELECT * FROM production_tasks;
```

**查询关系**:
```sql
SELECT * FROM material_device_relations;
SELECT * FROM material_mold_relations;
```

---

## 🎓 学习资源

### 文档

- `10-RULES-VERIFICATION-GUIDE.md` - 验证指南
- `10-RULES-QUICK-REFERENCE.md` - 快速参考
- `COMPREHENSIVE_DEMO_GUIDE.md` - 综合演示指南

### 代码

- `server/services/SchedulingEngine.js` - 排程引擎
- `scripts/init-10-rules-demo-data.js` - 演示数据脚本
- `client/src/components/SimpleScheduling.js` - 前端组件

### 数据库

- `database/scheduling_schema.sql` - 数据库架构

---

## ✅ 完成检查

快速开始完成后，检查以下内容：

- [ ] 演示数据已初始化
- [ ] 排程已执行
- [ ] 排程结果已查看
- [ ] 预期结果已验证
- [ ] 理解了10种规则
- [ ] 知道如何重置和重新初始化

---

## 🚀 下一步

### 如果一切正常

1. 阅读详细文档了解更多
2. 尝试调整权重值进行实验
3. 添加新的演示场景
4. 在实际业务中应用

### 如果遇到问题

1. 查看故障排除部分
2. 检查日志了解详情
3. 重新初始化数据
4. 联系技术支持

---

## 📋 快速命令参考

```bash
# 初始化演示数据
node scripts/init-10-rules-demo-data.js

# 启动后端服务
npm run dev

# 启动前端服务
cd client && npm start

# 查看后端日志
npm run dev

# 查看数据库
mysql -u root -p mes_system
```

---

## 🎉 开始体验

现在就开始体验10种排程规则吧！

```bash
# 1. 初始化演示数据
node scripts/init-10-rules-demo-data.js

# 2. 访问系统
# http://localhost:3000

# 3. 执行排程
# 点击"辅助排程" -> "执行自动排产"

# 4. 查看结果
# 点击"排程结果"标签页
```

**预计时间**: 5分钟  
**难度**: ⭐ 简单  
**收获**: 理解10种排程规则的应用

---

**祝您体验愉快！** 🎯
