# 10种排程规则快速参考

**版本**: v1.0  
**创建时间**: 2025-12-26  
**用途**: 快速查阅10种排程规则的定义和应用场景

---

## 📋 规则总览

| # | 规则名称 | 优先级 | 触发条件 | 应用场景 |
|---|---------|--------|---------|--------|
| 1️⃣ | 交期优先 | 低 | 交期紧张 | 紧急订单 |
| 2️⃣ | 设备权重优先 | 中 | 多个可用设备 | 设备选择 |
| 3️⃣ | 模具权重优先 | 中 | 多个可用模具 | 模具选择 |
| 4️⃣ | 模具-设备独占性 | 高 | 单副模具被占用 | 资源冲突 |
| 5️⃣ | 模具-设备绑定 | 最高 | 单副模具已分配 | 资源绑定 |
| 6️⃣ | 同物料一致性 | 中 | 相同物料已排产 | 物料聚集 |
| 7️⃣ | 同模具一致性 | 中 | 相同模具已使用 | 模具聚集 |
| 8️⃣ | 计划单唯一性 | 低 | 默认规则 | 标准排程 |
| 9️⃣ | 同模多物料同步 | 高 | 多物料共享模具 | 同步生产 |
| 🔟 | 多模具灵活排程 | 低 | 交期不足 | 灵活选择 |

---

## 🎯 详细规则说明

### 1️⃣ 交期优先

**定义**: 所有排程决策以满足交期为首要目标

**触发条件**:
- 计划单交期紧张（< 3天）
- 系统中已有其他任务

**应用场景**:
- 紧急订单处理
- 交期冲突解决
- 优先级调整

**示例**:
```
计划单: PL-URGENT-001
交期: 2天后
结果: 优先排程，即使不是最优资源配置
```

**业务意义**: 确保紧急订单不会因为资源优化而延期

---

### 2️⃣ 设备权重优先

**定义**: 权重高的设备优先选择

**触发条件**:
- 物料有多个可用设备
- 设备权重不同
- 没有其他约束条件

**应用场景**:
- 多设备选择
- 设备能力差异
- 生产效率优化

**示例**:
```
物料: MAT-001
可用设备: DEV-001(权重70), DEV-002(权重95), DEV-003(权重60)
选择: DEV-002 (权重最高)
```

**业务意义**: 优先使用高效能设备，提高生产效率

---

### 3️⃣ 模具权重优先

**定义**: 权重高的模具优先选择

**触发条件**:
- 物料有多个可用模具
- 模具权重不同
- 没有其他约束条件

**应用场景**:
- 多模具选择
- 模具精度差异
- 产品质量优化

**示例**:
```
物料: MAT-008 (高端手机壳)
可用模具: MOLD-006(权重100), MOLD-001(权重70)
选择: MOLD-006 (权重最高)
```

**业务意义**: 优先使用高精度模具，保证产品质量

---

### 4️⃣ 模具-设备独占性

**定义**: 同一模具同一时间只能分配到一台设备

**触发条件**:
- 模具已被占用（有时间冲突）
- 需要选择其他设备
- 模具是单副或数量有限

**应用场景**:
- 单副模具冲突
- 模具时间冲突
- 资源独占处理

**示例**:
```
模具: MOLD-002 (单副模具)
已占用时间: 10:00-12:00
新计划: 09:00-11:00 (时间冲突)
结果: 选择其他设备或延后时间
```

**业务意义**: 防止模具被多个设备同时使用，保证生产安全

---

### 5️⃣ 模具-设备绑定

**定义**: 单副模具一旦分配，后续必须分配到同一设备

**触发条件**:
- 模具是单副（quantity = 1）
- 模具已分配到某个设备
- 后续计划单使用同一模具

**应用场景**:
- 单副模具管理
- 设备专用模具
- 长期生产计划

**示例**:
```
第一个计划单: PL-BIND-001
模具: MOLD-008 (单副)
分配设备: DEV-001

第二个计划单: PL-BIND-002
模具: MOLD-008 (同一单副)
必须分配: DEV-001 (绑定)
```

**业务意义**: 确保单副模具的一致性，避免频繁更换

---

### 6️⃣ 同物料一致性

**定义**: 相同物料优先分配到同一设备和模具

**触发条件**:
- 相同物料已排产
- 新计划单使用同一物料
- 设备和模具可用

**应用场景**:
- 物料聚集生产
- 减少设备切换
- 提高生产连贯性

**示例**:
```
第一个计划单: PL-MAT-CONSIST-001
物料: MAT-010 (手机壳E)
分配: DEV-002 + MOLD-001

第二个计划单: PL-MAT-CONSIST-002
物料: MAT-010 (同一物料)
优先分配: DEV-002 + MOLD-001 (一致性)
```

**业务意义**: 减少设备和模具的切换次数，提高效率

---

### 7️⃣ 同模具一致性

**定义**: 使用相同模具的计划单优先分配到同一设备

**触发条件**:
- 相同模具已使用
- 新计划单使用同一模具
- 设备可用

**应用场景**:
- 模具聚集生产
- 减少模具切换
- 提高模具利用率

**示例**:
```
第一个计划单: PL-MOLD-CONSIST-001
物料: MAT-001 (手机壳A)
模具: MOLD-001
分配设备: DEV-001

第二个计划单: PL-MOLD-CONSIST-002
物料: MAT-002 (手机壳B)
模具: MOLD-001 (同一模具)
优先分配设备: DEV-001 (一致性)
```

**业务意义**: 减少模具切换，提高生产效率

---

### 8️⃣ 计划单唯一性

**定义**: 每个计划单完整分配到一台设备和一副模具

**触发条件**:
- 默认规则
- 其他规则都不适用
- 标准排程流程

**应用场景**:
- 标准计划单
- 无特殊约束
- 常规生产

**示例**:
```
计划单: PL-UNIQUE-001
物料: MAT-004 (电池盖板)
分配: DEV-003 + MOLD-004
```

**业务意义**: 确保每个计划单都能完整分配，基础排程规则

---

### 9️⃣ 同模多物料同步

**定义**: 使用同一模具生产多种物料需同步生产

**触发条件**:
- 多个计划单使用同一模具
- 物料不同
- 交期相近

**应用场景**:
- 多物料共享模具
- 同步生产计划
- 模具利用率优化

**示例**:
```
计划单1: PL-MULTI-MAT-001
物料: MAT-006 (手机壳C)
模具: MOLD-005
交期: 4天后

计划单2: PL-MULTI-MAT-002
物料: MAT-007 (手机壳D)
模具: MOLD-005 (同一模具)
交期: 4天后

结果: 同步排程到同一设备和时间
```

**业务意义**: 提高模具利用率，减少模具切换

---

### 🔟 多模具灵活排程

**定义**: 交期不足时可灵活选择其他设备和模具

**触发条件**:
- 交期紧张
- 多个设备和模具可用
- 需要灵活调整

**应用场景**:
- 交期冲突
- 资源紧张
- 灵活生产

**示例**:
```
计划单: PL-FLEXIBLE-001
物料: MAT-009 (标准手机壳)
交期: 3天后 (紧张)
可用设备: DEV-006(权重50), DEV-001(权重70)
可用模具: MOLD-007(权重50), MOLD-001(权重75)
结果: 灵活选择可用资源，优先满足交期
```

**业务意义**: 在交期紧张时灵活调整，确保按时交付

---

## 🔄 规则优先级关系

```
最高优先级:
  5️⃣ 模具-设备绑定 (单副模具已分配)
  9️⃣ 同模多物料同步 (多物料共享模具)

高优先级:
  4️⃣ 模具-设备独占性 (单副模具冲突)

中优先级:
  2️⃣ 设备权重优先 (多设备选择)
  3️⃣ 模具权重优先 (多模具选择)
  6️⃣ 同物料一致性 (相同物料)
  7️⃣ 同模具一致性 (相同模具)

低优先级:
  1️⃣ 交期优先 (交期紧张)
  🔟 多模具灵活排程 (灵活选择)
  8️⃣ 计划单唯一性 (默认规则)
```

---

## 📊 规则应用场景矩阵

| 场景 | 适用规则 | 优先级 |
|------|---------|--------|
| 紧急订单 | 1️⃣ 交期优先 | 低 |
| 多设备选择 | 2️⃣ 设备权重优先 | 中 |
| 多模具选择 | 3️⃣ 模具权重优先 | 中 |
| 单副模具冲突 | 4️⃣ 模具-设备独占性 | 高 |
| 单副模具绑定 | 5️⃣ 模具-设备绑定 | 最高 |
| 相同物料 | 6️⃣ 同物料一致性 | 中 |
| 相同模具 | 7️⃣ 同模具一致性 | 中 |
| 标准排程 | 8️⃣ 计划单唯一性 | 低 |
| 多物料共享模具 | 9️⃣ 同模多物料同步 | 高 |
| 交期不足 | 🔟 多模具灵活排程 | 低 |

---

## 💡 使用建议

### 对于排程人员

1. **理解规则优先级**: 高优先级规则会覆盖低优先级规则
2. **识别触发条件**: 了解每个规则的触发条件
3. **优化权重配置**: 通过调整权重影响排程结果
4. **监控排程原因**: 定期检查排程原因分布

### 对于系统管理员

1. **验证规则逻辑**: 确保规则检测正确
2. **调整规则参数**: 根据业务需求调整
3. **监控系统性能**: 观察排程效率
4. **支持用户培训**: 帮助用户理解规则

### 对于业务决策者

1. **分析排程结果**: 理解排程系统的决策
2. **优化资源配置**: 根据排程原因调整资源
3. **改进流程**: 基于排程数据改进生产流程
4. **成本控制**: 通过规则优化降低成本

---

## 🔗 相关文档

- `10-RULES-VERIFICATION-GUIDE.md` - 10种规则验证指南
- `COMPREHENSIVE_DEMO_GUIDE.md` - 综合演示数据指南
- `server/services/SchedulingEngine.js` - 排程引擎源代码

---

## 📞 常见问题

**Q: 如何判断哪个规则被应用了？**
A: 查看排程结果中的"排程原因"列，会显示应用的具体规则。

**Q: 规则优先级如何影响排程？**
A: 高优先级规则会优先检查，如果满足条件就应用该规则，不再检查低优先级规则。

**Q: 如何调整规则的应用？**
A: 通过修改权重值、关系配置或交期来影响规则的触发条件。

**Q: 能否禁用某个规则？**
A: 可以通过修改排程引擎的代码来禁用或修改规则逻辑。

---

**快速查阅完成！** 🎯
